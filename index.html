<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@foxxmd/logging Docs</title><meta name="description" content="Documentation for @foxxmd/logging Docs"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"><a href="http://foxxmd.github.io/logging">Docs</a><a href="https://github.com/foxxmd/logging">GitHub</a></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">@foxxmd/logging Docs</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h2>@foxxmd/logging Docs</h2></div><div class="tsd-panel tsd-typography"><a id="md:foxxmdlogging" class="tsd-anchor"></a><h1><a href="#md:foxxmdlogging">@foxxmd/logging</a></h1><p><a href="https://github.com/FoxxMD/logging/releases"><img src="https://img.shields.io/github/v/release/foxxmd/logging" alt="Latest Release"></a>
<a href="https://www.npmjs.com/package/@foxxmd/logging"><img src="https://img.shields.io/npm/v/%40foxxmd%2Flogging" alt="NPM Version"></a>
<a href="https://npm.runkit.com/%40foxxmd%2Flogging"><img src="https://img.shields.io/static/v1?label=Try%20it%20online%20on&message=RunKit&color=f55fa6" alt="Try on Runkit"></a>
<a href="https://opensource.org/licenses/MIT"><img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License: MIT"></a></p>
<p>A typed, opinionated, batteries-included, <a href="https://getpino.io">Pino</a>-based logging solution for backend TS/JS projects.</p>
<p>Features:</p>
<ul>
<li>Fully typed for Typescript projects</li>
<li>One-line, <a href="#md:quick-start">turn-key logging</a> to console and rotating file</li>
<li><a href="#md:child-loggers">Child (nested) loggers</a> with hierarchical label prefixes for log messages</li>
<li>Per-destination level filtering configurable via ENV or arguments</li>
<li>Clean, opinionated log output format powered by <a href="https://github.com/pinojs/pino-pretty">pino-pretty</a>:<ul>
<li>Colorized output when stream is TTY and supports it</li>
<li>Automatically <a href="#md:serializing-objects-and-errors">serialize passed objects and Errors</a>, including <a href="https://github.com/tc39/proposal-error-cause">Error Cause</a></li>
<li>Automatically redact current working directory from log output</li>
</ul>
</li>
<li><a href="#md:additional-app-logger-configuration">Bring-Your-Own settings</a><ul>
<li>Add or use your own streams/<a href="https://getpino.io/#/docs/transports?id=known-transports">transports</a> for destinations</li>
<li>All pino-pretty configs are exposed and extensible</li>
</ul>
</li>
<li><a href="#md:building-a-logger">Build-Your-Own Logger</a><ul>
<li>Don&#39;t want to use any of the pre-built transports? Leverage the convenience of @foxxmd/logging wrappers and default settings but build your logger from scratch</li>
</ul>
</li>
</ul>
<img src="media/example.svg" alt="example log output">

<p><strong>Documentation best viewed on <a href="https://foxxmd.github.io/logging">https://foxxmd.github.io/logging</a></strong></p>
<a id="md:install" class="tsd-anchor"></a><h1><a href="#md:install">Install</a></h1><pre><code><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-0">install</span><span class="hl-1"> @</span><span class="hl-0">foxxmd</span><span class="hl-1">/</span><span class="hl-0">logging</span>
</code><button>Copy</button></pre>
<a id="md:quick-start" class="tsd-anchor"></a><h1><a href="#md:quick-start">Quick Start</a></h1><pre><code class="language-ts"><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">loggerAppRolling</span><span class="hl-1">, </span><span class="hl-0">loggerApp</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@foxxmd/logging&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">logger</span><span class="hl-1"> = </span><span class="hl-6">loggerApp</span><span class="hl-1">();</span><br/><span class="hl-0">logger</span><span class="hl-1">.</span><span class="hl-6">info</span><span class="hl-1">(</span><span class="hl-3">&#39;Test&#39;</span><span class="hl-1">);</span><br/><span class="hl-7">/*</span><br/><span class="hl-7"> * Logs to -&gt; console, colorized</span><br/><span class="hl-7"> * Logs to -&gt; CWD/logs/app.log</span><br/><span class="hl-7"> * </span><br/><span class="hl-7"> * [2024-03-07 10:31:34.963 -0500] DEBUG: Test</span><br/><span class="hl-7"> * */</span><br/><br/><br/><span class="hl-7">// or for rolling log files we need to scan logs dir before opening a file</span><br/><span class="hl-7">// and need to await initial logger</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">rollingLogger</span><span class="hl-1"> = </span><span class="hl-2">await</span><span class="hl-1"> </span><span class="hl-6">loggerAppRolling</span><span class="hl-1">();</span><br/><span class="hl-0">rollingLogger</span><span class="hl-1">.</span><span class="hl-6">info</span><span class="hl-1">(</span><span class="hl-3">&#39;Test&#39;</span><span class="hl-1">);</span><br/><span class="hl-7">/*</span><br/><span class="hl-7"> * Logs to -&gt; console, colorized</span><br/><span class="hl-7"> * Logs to daily log file, max 10MB size -&gt; CWD/logs/app.1.log</span><br/><span class="hl-7"> * </span><br/><span class="hl-7"> * [2024-03-07 10:31:34.963 -0500] DEBUG: Test</span><br/><span class="hl-7"> * */</span>
</code><button>Copy</button></pre>
<a id="md:loggers" class="tsd-anchor"></a><h1><a href="#md:loggers">Loggers</a></h1><p>The package exports 4 top-level loggers.</p>
<a id="md:app-loggers" class="tsd-anchor"></a><h3><a href="#md:app-loggers">App Loggers</a></h3><p>These are the loggers that should be used for the majority of your application. They accept an optional configuration object for configuring log destinations.</p>
<ul>
<li><a href="https://foxxmd.github.io/logging/functions/index.loggerApp.html"><code>loggerApp</code></a> - Logs to console and a fixed file destination</li>
<li><a href="https://foxxmd.github.io/logging/functions/index.loggerAppRolling.html"><code>loggerAppRolling</code></a> - Logs to console and a rolling file destination</li>
</ul>
<a id="md:helper-loggers" class="tsd-anchor"></a><h3><a href="#md:helper-loggers">Helper Loggers</a></h3><p>These loggers are pre-defined for specific use cases:</p>
<ul>
<li><a href="https://foxxmd.github.io/logging/variables/index.loggerDebug.html"><code>loggerDebug</code></a> - Logs ONLY to console at minimum <code>debug</code> level. Can be used during application startup before a logger app configuration has been parsed.</li>
<li><a href="https://foxxmd.github.io/logging/variables/index.loggerTest.html"><code>loggerTest</code></a> - A noop logger (will not log anywhere) for use in tests/mockups.</li>
</ul>
<a id="md:configuring" class="tsd-anchor"></a><h2><a href="#md:configuring">Configuring</a></h2><p>The <a href="#md:app-loggers">App Loggers</a> take an optional <a href="https://foxxmd.github.io/logging/interfaces/index.LogOptions.html"><code>LogOptions</code></a> to configure <a href="https://foxxmd.github.io/logging/types/index.LogLevel.html"><code>LogLevel</code></a> globally or individually for <strong>Console</strong> and <strong>File</strong> outputs. <a href="https://foxxmd.github.io/logging/interfaces/index.FileLogOptions.html"><code>file</code> in <code>LogOptions</code></a> may also be an object that specifies more behavior for log file output.</p>
<pre><code class="language-ts"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">infoLogger</span><span class="hl-1"> = </span><span class="hl-6">loggerApp</span><span class="hl-1">({</span><br/><span class="hl-1"> </span><span class="hl-0">level:</span><span class="hl-1"> </span><span class="hl-3">&#39;info&#39;</span><span class="hl-1"> </span><span class="hl-7">// console and file will log any levels `info` and above</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">logger</span><span class="hl-1"> = </span><span class="hl-6">loggerApp</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-0">console:</span><span class="hl-1"> </span><span class="hl-3">&#39;debug&#39;</span><span class="hl-1">, </span><span class="hl-7">// console will log `debug` and higher</span><br/><span class="hl-1">  </span><span class="hl-0">file:</span><span class="hl-1"> </span><span class="hl-3">&#39;warn&#39;</span><span class="hl-1"> </span><span class="hl-7">// file will log `warn` and higher</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">fileLogger</span><span class="hl-1"> = </span><span class="hl-6">loggerRollingApp</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-7">// no level specified =&gt; console defaults to `info` level</span><br/><span class="hl-1">  </span><span class="hl-0">file:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">level:</span><span class="hl-1"> </span><span class="hl-3">&#39;warn&#39;</span><span class="hl-1">, </span><span class="hl-7">// file will log `warn` and higher</span><br/><span class="hl-1">      </span><span class="hl-0">path:</span><span class="hl-1"> </span><span class="hl-3">&#39;/my/cool/path/output.log&#39;</span><span class="hl-1">, </span><span class="hl-7">// output to log file at this path</span><br/><span class="hl-1">      </span><span class="hl-0">frequency:</span><span class="hl-1"> </span><span class="hl-3">&#39;daily&#39;</span><span class="hl-1">, </span><span class="hl-7">// rotate hourly</span><br/><span class="hl-1">      </span><span class="hl-0">size:</span><span class="hl-1"> </span><span class="hl-3">&#39;20MB&#39;</span><span class="hl-1">, </span><span class="hl-7">// rotate if file size grows larger than 20MB</span><br/><span class="hl-1">      </span><span class="hl-0">timestamp:</span><span class="hl-1"> </span><span class="hl-3">&#39;unix&#39;</span><span class="hl-1"> </span><span class="hl-7">// use unix epoch timestamp instead of iso8601 in rolling file</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span>
</code><button>Copy</button></pre>
<p>An optional second parameter, <a href="https://foxxmd.github.io/logging/interfaces/index.LoggerAppExtras.html"><code>LoggerAppExtras</code></a>, may be passed that allows adding additional log destinations or pino-pretty customization to the <a href="#md:app-loggers">App Loggers</a>. Some defaults and convenience variables for pino-pretty options are also available in <a href="(https://foxxmd.github.io/logging/modules/factory.html)"><code>@foxxmd/logging/factory</code></a> prefixed with <code>PRETTY_</code>.</p>
<p>An example using <code>LoggerAppExtras</code>:</p>
<pre><code class="language-ts"><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">loggerApp</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&#39;@foxxmd/logging&#39;</span><span class="hl-1">;</span><br/><span class="hl-2">import</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">PRETTY_ISO8601</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">buildDestinationFile</span><span class="hl-1"> </span><br/><span class="hl-1">} </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@foxxmd/logging/factory&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-7">// additional file logging but only at `warn` or higher</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">warnFileDestination</span><span class="hl-1"> = </span><span class="hl-6">buildDestinationFile</span><span class="hl-1">(</span><span class="hl-3">&#39;warn&#39;</span><span class="hl-1">, {</span><span class="hl-0">path:</span><span class="hl-1"> </span><span class="hl-3">&#39;./myLogs/warn.log&#39;</span><span class="hl-1">});</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">logger</span><span class="hl-1"> = </span><span class="hl-6">loggerApp</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-0">level:</span><span class="hl-1"> </span><span class="hl-3">&#39;debug&#39;</span><span class="hl-1">, </span><span class="hl-7">// console AND built-in file logging will log `debug` and higher</span><br/><span class="hl-1">  }, {</span><br/><span class="hl-1">   </span><span class="hl-0">destinations:</span><span class="hl-1"> [</span><span class="hl-0">warnFileDestination</span><span class="hl-1">],</span><br/><span class="hl-1">   </span><span class="hl-0">pretty:</span><span class="hl-1"> {</span><br/><span class="hl-1">     </span><span class="hl-0">translateTime:</span><span class="hl-1"> </span><span class="hl-5">PRETTY_ISO8601</span><span class="hl-1"> </span><span class="hl-7">// replaces standard timestamp with ISO8601 format</span><br/><span class="hl-1">   }</span><br/><span class="hl-1">});</span><br/><span class="hl-0">logger</span><span class="hl-1">.</span><span class="hl-6">debug</span><span class="hl-1">(</span><span class="hl-3">&#39;Test&#39;</span><span class="hl-1">);</span><br/><span class="hl-7">// [2024-03-07T11:27:41-05:00] DEBUG: Test</span>
</code><button>Copy</button></pre>
<p>See <a href="#md:building-a-logger">Building A Logger</a> for more information.</p>
<a id="md:colorizing-docker-logs" class="tsd-anchor"></a><h4><a href="#md:colorizing-docker-logs">Colorizing Docker Logs</a></h4><p>Color output to STD out/err is normally automatically detected by <a href="https://github.com/jorgebucaran/colorette">colorette</a> or can manually be set using <code>colorize</code> anywhere <a href="https://foxxmd.github.io/logging/interfaces/factory._internal_.PrettyOptions_.html">PrettyOptions</a> are accepted. However docker output can be hard to detect as supporting colorizing, or the output may not be TTY at the container interface but is viewed by a terminal or web app that does support colorizing.</p>
<p>Therefore <code>@foxxmd/logging</code> will look for a <code>COLORED_STD</code> environmental variable and, if no other <code>colorize</code> option is set <em>and the ENV is not empty</em>, will use the truthy value of this variable to set <code>colorize</code> <strong>for any <code>buildDestinationStdout</code> or <code>buildDestinationStderr</code> transports.</strong> This includes the built-in stdout transports for <code>loggerApp</code> and <code>loggerAppRolling</code>.</p>
<p>Thus you could set <code>COLORED_STD=true</code> in your Dockerfile to coerce colored output to docker logs. If a user does not want colored output for any reason they can simply override the environmental variable like <code>COLORED_STD=false</code></p>
<a id="md:usage" class="tsd-anchor"></a><h2><a href="#md:usage">Usage</a></h2><a id="md:child-loggers" class="tsd-anchor"></a><h3><a href="#md:child-loggers">Child Loggers</a></h3><p><a href="https://getpino.io/#/docs/child-loggers">Pino Child loggers</a> can be created using the <a href="https://foxxmd.github.io/logging/functions/index.childLogger.html"><code>childLogger</code></a> function with the added ability to inherit <strong>Labels</strong> from their parent loggers.</p>
<p><strong>Labels</strong> are inserted between the log level and message contents of a log. The child logger inherits <strong>all</strong> labels from <strong>all</strong> its parent loggers.</p>
<p><code>childLogger</code> accepts a single string label or an array of string labels.</p>
<pre><code class="language-ts"><span class="hl-2">import</span><span class="hl-1"> {</span><span class="hl-0">loggerApp</span><span class="hl-1">, </span><span class="hl-0">childLogger</span><span class="hl-1">} </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&#39;@foxxmd/logging&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">logger</span><span class="hl-1"> = </span><span class="hl-6">loggerApp</span><span class="hl-1">();</span><br/><span class="hl-0">logger</span><span class="hl-1">.</span><span class="hl-6">debug</span><span class="hl-1">(</span><span class="hl-3">&#39;Test&#39;</span><span class="hl-1">);</span><br/><span class="hl-7">// [2024-03-07 11:27:41.944 -0500] DEBUG: Test</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">nestedChild1</span><span class="hl-1"> = </span><span class="hl-6">childLogger</span><span class="hl-1">(</span><span class="hl-0">logger</span><span class="hl-1">, </span><span class="hl-3">&#39;First&#39;</span><span class="hl-1">);</span><br/><span class="hl-0">nestedChild1</span><span class="hl-1">.</span><span class="hl-6">debug</span><span class="hl-1">(</span><span class="hl-3">&#39;I am nested one level&#39;</span><span class="hl-1">);</span><br/><span class="hl-7">// [2024-03-07 11:27:41.945 -0500] DEBUG: [First] I am nested one level</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">nestedChild2</span><span class="hl-1"> = </span><span class="hl-6">childLogger</span><span class="hl-1">(</span><span class="hl-0">nestedChild1</span><span class="hl-1">, [</span><span class="hl-3">&#39;Second&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;Third&#39;</span><span class="hl-1">]);</span><br/><span class="hl-0">nestedChild2</span><span class="hl-1">.</span><span class="hl-6">warn</span><span class="hl-1">(</span><span class="hl-3">&#39;I am nested two levels but with more labels&#39;</span><span class="hl-1">);</span><br/><span class="hl-7">// [2024-03-07 11:27:41.945 -0500] WARN: [First] [Second] [Third] I am nested two levels but with more labels</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">siblingLogger</span><span class="hl-1"> = </span><span class="hl-6">childLogger</span><span class="hl-1">(</span><span class="hl-0">logger</span><span class="hl-1">, [</span><span class="hl-3">&#39;1Sib&#39;</span><span class="hl-1">,</span><span class="hl-3">&#39;2Sib&#39;</span><span class="hl-1">]);</span><br/><span class="hl-0">siblingLogger</span><span class="hl-1">.</span><span class="hl-6">info</span><span class="hl-1">(</span><span class="hl-3">&#39;Test&#39;</span><span class="hl-1">);</span><br/><span class="hl-7">// [2024-03-07 11:27:41.945 -0500] INFO: [1Sib] [2Sib] Test</span>
</code><button>Copy</button></pre>
<p>Labels can also be added at &quot;runtime&quot; by passing an object with <code>labels</code> prop to the logger level function. These labels will be appended to any existing labels on the logger.</p>
<pre><code class="language-ts"><span class="hl-0">logger</span><span class="hl-1">.</span><span class="hl-6">debug</span><span class="hl-1">({</span><span class="hl-0">labels:</span><span class="hl-1"> [</span><span class="hl-3">&#39;MyLabel&#39;</span><span class="hl-1">]}, </span><span class="hl-3">&#39;My log message&#39;</span><span class="hl-1">);</span>
</code><button>Copy</button></pre>
<a id="md:serializing-objects-and-errors" class="tsd-anchor"></a><h3><a href="#md:serializing-objects-and-errors">Serializing Objects and Errors</a></h3><p>Passing an object or array as the first argument to the logger will cause the object to be JSONified and pretty printed below the log message</p>
<pre><code class="language-ts"><span class="hl-0">logger</span><span class="hl-1">.</span><span class="hl-6">debug</span><span class="hl-1">({</span><span class="hl-0">myProp:</span><span class="hl-1"> </span><span class="hl-3">&#39;a string&#39;</span><span class="hl-1">, </span><span class="hl-0">nested:</span><span class="hl-1"> {</span><span class="hl-0">anotherProps:</span><span class="hl-1"> [</span><span class="hl-3">&#39;val1&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;val2&#39;</span><span class="hl-1">], </span><span class="hl-0">boolProp:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">}}, </span><span class="hl-3">&#39;Test&#39;</span><span class="hl-1">);</span><br/><span class="hl-1"> </span><span class="hl-7">/*</span><br/><span class="hl-7">[2024-03-07 11:39:37.687 -0500] DEBUG: Test</span><br/><span class="hl-7">  myProp: &quot;a string&quot;</span><br/><span class="hl-7">  nested: {</span><br/><span class="hl-7">    &quot;anotherProps&quot;: [</span><br/><span class="hl-7">      &quot;val1&quot;,</span><br/><span class="hl-7">      &quot;val2&quot;</span><br/><span class="hl-7">     ],</span><br/><span class="hl-7">   &quot;boolProp&quot;: true</span><br/><span class="hl-7">  }</span><br/><span class="hl-7">  */</span>
</code><button>Copy</button></pre>
<p>Passing an <code>Error</code> as the first argument will pretty print the error stack including any <a href="https://github.com/tc39/proposal-error-cause">causes.</a></p>
<pre><code class="language-ts"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">er</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">Error</span><span class="hl-1">(</span><span class="hl-3">&#39;This is the original error&#39;</span><span class="hl-1">);</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">causeErr</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">ErrorWithCause</span><span class="hl-1">(</span><span class="hl-3">&#39;A top-level error&#39;</span><span class="hl-1">, {</span><span class="hl-0">cause:</span><span class="hl-1"> </span><span class="hl-0">er</span><span class="hl-1">});</span><br/><span class="hl-0">logger</span><span class="hl-1">.</span><span class="hl-6">debug</span><span class="hl-1">(</span><span class="hl-0">causeErr</span><span class="hl-1">, </span><span class="hl-3">&#39;Test&#39;</span><span class="hl-1">);</span><br/><span class="hl-7">/*</span><br/><span class="hl-7">[2024-03-07 11:43:27.453 -0500] DEBUG: Test</span><br/><span class="hl-7">Error: A top-level error</span><br/><span class="hl-7">    at &lt;anonymous&gt; (/my/dir/src/index.ts:55:18)</span><br/><span class="hl-7">caused by: Error: This is the original error</span><br/><span class="hl-7">    at &lt;anonymous&gt; (/my/dir/src/index.ts:54:12)</span><br/><span class="hl-7"> */</span>
</code><button>Copy</button></pre>
<p>Passing an <code>Error</code> without a second argument (message) will cause the top-level error&#39;s message to be printed instead of log message.</p>
<a id="md:building-a-logger" class="tsd-anchor"></a><h1><a href="#md:building-a-logger">Building A Logger</a></h1><p>All the functionality required to build your own logger is exported by <a href="https://foxxmd.github.io/logging/modules/factory.html"><code>@foxxmd/logging/factory</code></a>. You can customize almost every facet of logging.</p>
<p>A logger is composed of a minimum default level and array of objects that implement <a href="https://foxxmd.github.io/logging/interfaces/index._internal_.StreamEntry-1.html"><code>StreamEntry</code></a>, the same interface used by <a href="https://getpino.io/#/docs/api?id=pino-multistream"><code>pino.multistream</code></a>. The only constraint is that your streams must accept the same levels as <code>@foxxmd/logging</code> using the <a href="https://foxxmd.github.io/logging/types/index.LogLevelStreamEntry.html"><code>LogLevelStreamEntry</code></a> interface that extends <code>StreamEntry</code>.</p>
<pre><code class="language-ts"><span class="hl-2">import</span><span class="hl-1"> {</span><span class="hl-0">LogLevelStreamEntry</span><span class="hl-1">} </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&#39;@foxxmd/logging&#39;</span><span class="hl-1">;</span><br/><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">buildLogger</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@foxxmd/logging/factory&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">myStreams</span><span class="hl-1">: </span><span class="hl-8">LogLevelStreamEntry</span><span class="hl-1">[] = [];</span><br/><span class="hl-7">// build streams</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">logger</span><span class="hl-1"> = </span><span class="hl-6">buildLogger</span><span class="hl-1">(</span><span class="hl-3">&#39;debug&#39;</span><span class="hl-1">, </span><span class="hl-0">myStreams</span><span class="hl-1">);</span><br/><span class="hl-0">logger</span><span class="hl-1">.</span><span class="hl-6">debug</span><span class="hl-1">(</span><span class="hl-3">&#39;Test&#39;</span><span class="hl-1">);</span>
</code><button>Copy</button></pre>
<p><code>factory</code> exports several &quot;destination&quot; <code>LogLevelStreamEntry</code> function creators with default configurations that can be overridden.</p>
<pre><code class="language-ts"><span class="hl-2">import</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">buildLogger</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">buildDestinationStream</span><span class="hl-1">,     </span><span class="hl-7">// generic NodeJS.WriteableStream or SonicBoom DestinationStream</span><br/><span class="hl-1">    </span><span class="hl-0">buildDestinationStdout</span><span class="hl-1">,     </span><span class="hl-7">// stream to STDOUT</span><br/><span class="hl-1">    </span><span class="hl-0">buildDestinationStderr</span><span class="hl-1">,     </span><span class="hl-7">// stream to STDERR</span><br/><span class="hl-1">    </span><span class="hl-0">buildDestinationFile</span><span class="hl-1">,       </span><span class="hl-7">// write to static file</span><br/><span class="hl-1">    </span><span class="hl-0">buildDestinationRollingFile</span><span class="hl-1"> </span><span class="hl-7">// write to rolling file</span><br/><span class="hl-1">} </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@foxxmd/logging/factory&quot;</span><span class="hl-1">;</span>
</code><button>Copy</button></pre>
<p>All <code>buildDestination</code> functions take args:</p>
<ul>
<li><code>level</code> (first arg) - minimum level to log at</li>
<li><code>options</code> (second arg) - an object extending <a href="https://github.com/pinojs/pino-pretty?tab=readme-ov-file#options"><code>pino-pretty</code> options</a>, <a href="https://foxxmd.github.io/logging/interfaces/factory._internal_.PrettyOptions_.html"><code>PrettyOptions</code></a></li>
</ul>
<p><code>options</code> inherits a default <code>pino-pretty</code> configuration that comprises <code>@foxxmd/logging</code>&#39;s opinionated logging format. The common default config can be generated using <a href="https://foxxmd.github.io/logging/functions/factory.prettyOptsFactory.html"><code>prettyOptsFactory</code></a> which accepts an optional <code>PrettyOptions</code> object to override defaults:</p>
<pre><code class="language-ts"><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">prettyOptsFactory</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@foxxmd/logging/factory&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">defaultConfig</span><span class="hl-1"> = </span><span class="hl-6">prettyOptsFactory</span><span class="hl-1">();</span><br/><br/><span class="hl-7">// override with your own config</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">myCustomizedConfig</span><span class="hl-1"> = </span><span class="hl-6">prettyOptsFactory</span><span class="hl-1">({ </span><span class="hl-0">colorize:</span><span class="hl-1"> </span><span class="hl-4">false</span><span class="hl-1"> });</span>
</code><button>Copy</button></pre>
<p>Pre-configured <code>PrettyOptions</code> are also provided for different destinations:</p>
<pre><code class="language-ts"><span class="hl-2">import</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">PRETTY_OPTS_CONSOLE</span><span class="hl-1">, </span><span class="hl-7">// default config</span><br/><span class="hl-1">  </span><span class="hl-0">PRETTY_OPTS_FILE</span><span class="hl-1">     </span><span class="hl-7">// disables colorize</span><br/><span class="hl-1">} </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@foxxmd/logging/factory&quot;</span><span class="hl-1">;</span>
</code><button>Copy</button></pre>
<p>Specific buildDestinations also require passing a stream or path:</p>
<p><a href="https://foxxmd.github.io/logging/functions/factory.buildDestinationStream.html"><code>buildDestinationStream</code></a> must pass a <code>NodeJS.WriteableStream</code> or SonicBoom <code>DestinationStream</code> to options as <a href="https://foxxmd.github.io/logging/types/factory.StreamDestination.html"><code>destination</code></a></p>
<pre><code class="language-ts"><span class="hl-2">import</span><span class="hl-1"> {</span><span class="hl-0">buildDestinationStream</span><span class="hl-1">} </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@foxxmd/logging/factory&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">myStream</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">WritableStream</span><span class="hl-1">();</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">dest</span><span class="hl-1"> = </span><span class="hl-6">buildDestinationStream</span><span class="hl-1">(</span><span class="hl-3">&#39;debug&#39;</span><span class="hl-1">, {</span><span class="hl-0">destination:</span><span class="hl-1"> </span><span class="hl-0">myStream</span><span class="hl-1">});</span>
</code><button>Copy</button></pre>
<p><a href="https://foxxmd.github.io/logging/functions/factory.buildDestinationStdout.html"><code>buildDestinationStdout</code></a> and <a href="https://foxxmd.github.io/logging/functions/factory.buildDestinationStderr.html"><code>buildDestinationStderr</code></a> do not require a destination as they are fixed to STDOUT/STDERR</p>
<p><a href="https://foxxmd.github.io/logging/functions/factory.buildDestinationFile.html"><code>buildDestinationFile</code></a> and <a href="https://foxxmd.github.io/logging/functions/factory.buildDestinationRollingFile.html"><code>buildDestinationRollingFile</code></a> must pass a <a href="https://foxxmd.github.io/logging/types/factory.FileDestination.html"><code>path</code></a> to options</p>
<pre><code class="language-ts"><span class="hl-2">import</span><span class="hl-1"> {</span><span class="hl-0">buildDestinationFile</span><span class="hl-1">} </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@foxxmd/logging/factory&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">dest</span><span class="hl-1"> = </span><span class="hl-6">buildDestinationFile</span><span class="hl-1">(</span><span class="hl-3">&#39;debug&#39;</span><span class="hl-1">, {</span><span class="hl-0">path:</span><span class="hl-1"> </span><span class="hl-3">&#39;/path/to/file.log&#39;</span><span class="hl-1">});</span>
</code><button>Copy</button></pre>
<a id="md:example" class="tsd-anchor"></a><h3><a href="#md:example">Example</a></h3><p>Putting everything above together</p>
<pre><code class="language-ts"><span class="hl-2">import</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">buildDestinationStream</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">buildDestinationFile</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">prettyOptsFactory</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">buildDestinationStdout</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">buildLogger</span><br/><span class="hl-1">} </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@foxxmd/logging/factory&quot;</span><span class="hl-1">;</span><br/><span class="hl-2">import</span><span class="hl-1"> { </span><span class="hl-0">PassThrough</span><span class="hl-1"> } </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&quot;node:stream&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">hookStream</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">PassThrough</span><span class="hl-1">();</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">hookDestination</span><span class="hl-1"> = </span><span class="hl-6">buildDestinationStream</span><span class="hl-1">(</span><span class="hl-3">&#39;debug&#39;</span><span class="hl-1">, {</span><br/><span class="hl-1">  ...</span><span class="hl-6">prettyOptsFactory</span><span class="hl-1">({</span><span class="hl-0">sync:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">, </span><span class="hl-0">ignore:</span><span class="hl-1"> </span><span class="hl-3">&#39;pid&#39;</span><span class="hl-1">}),</span><br/><span class="hl-1">  </span><span class="hl-0">destination:</span><span class="hl-1"> </span><span class="hl-0">hookStream</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">debugFileDestination</span><span class="hl-1"> = </span><span class="hl-6">buildDestinationFile</span><span class="hl-1">(</span><span class="hl-3">&#39;debug&#39;</span><span class="hl-1">, {</span><span class="hl-0">path:</span><span class="hl-1"> </span><span class="hl-3">&#39;./myLogs/debug.log&#39;</span><span class="hl-1">});</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">warnFileDestination</span><span class="hl-1"> = </span><span class="hl-6">buildDestinationFile</span><span class="hl-1">(</span><span class="hl-3">&#39;warn&#39;</span><span class="hl-1">, {</span><span class="hl-0">path:</span><span class="hl-1"> </span><span class="hl-3">&#39;./myLogs/warn.log&#39;</span><span class="hl-1">});</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">logger</span><span class="hl-1"> = </span><span class="hl-6">buildLogger</span><span class="hl-1">(</span><span class="hl-3">&#39;debug&#39;</span><span class="hl-1">, [</span><br/><span class="hl-1">  </span><span class="hl-0">hookDestination</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">buildDestinationStdout</span><span class="hl-1">(</span><span class="hl-3">&#39;debug&#39;</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-0">debugFileDestination</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">warnFileDestination</span><br/><span class="hl-1">]);</span><br/><span class="hl-0">hookStream</span><span class="hl-1">.</span><span class="hl-6">on</span><span class="hl-1">(</span><span class="hl-3">&#39;data&#39;</span><span class="hl-1">, (</span><span class="hl-0">log</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-0">log</span><span class="hl-1">)});</span><br/><span class="hl-0">logger</span><span class="hl-1">.</span><span class="hl-6">debug</span><span class="hl-1">(</span><span class="hl-3">&#39;Test&#39;</span><span class="hl-1">)</span><br/><span class="hl-7">// logs to hookStream</span><br/><span class="hl-7">// logs to STDOUT</span><br/><span class="hl-7">// logs to file ./myLogs/debug.log</span><br/><span class="hl-7">// does NOT log to file ./myLogs/warn.log</span>
</code><button>Copy</button></pre>
<a id="md:parsing-logoptions" class="tsd-anchor"></a><h3><a href="#md:parsing-logoptions">Parsing LogOptions</a></h3><p>If you wish to use <a href="#md:configuring"><code>LogOptions</code></a> to get default log levels for your destinations use <a href="https://foxxmd.github.io/logging/functions/index.parseLogOptions.html"><code>parseLogOptions</code></a>:</p>
<pre><code class="language-ts"><span class="hl-2">import</span><span class="hl-1"> {</span><span class="hl-0">parseLogOptions</span><span class="hl-1">, </span><span class="hl-0">LogOptions</span><span class="hl-1">} </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-3">&#39;@foxxmd/logging&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">parsedOptions</span><span class="hl-1">: </span><span class="hl-8">LogOptions</span><span class="hl-1"> = </span><span class="hl-6">parseLogOptions</span><span class="hl-1">(</span><span class="hl-0">myConfig</span><span class="hl-1">);</span>
</code><button>Copy</button></pre>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-index-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><h4 class="uppercase">Member Visibility</h4><form><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div><div class="tsd-theme-toggle"><h4 class="uppercase">Theme</h4><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-index-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:foxxmdlogging"><span>@foxxmd/logging</span></a><a href="#md:install"><span>Install</span></a><a href="#md:quick-start"><span>Quick <wbr/>Start</span></a><a href="#md:loggers"><span>Loggers</span></a><ul><li><ul><li><a href="#md:app-loggers"><span>App <wbr/>Loggers</span></a></li><li><a href="#md:helper-loggers"><span>Helper <wbr/>Loggers</span></a></li></ul></li><li><a href="#md:configuring"><span>Configuring</span></a></li><li><ul><li><ul><li><a href="#md:colorizing-docker-logs"><span>Colorizing <wbr/>Docker <wbr/>Logs</span></a></li></ul></li></ul></li><li><a href="#md:usage"><span>Usage</span></a></li><li><ul><li><a href="#md:child-loggers"><span>Child <wbr/>Loggers</span></a></li><li><a href="#md:serializing-objects-and-errors"><span>Serializing <wbr/>Objects and <wbr/>Errors</span></a></li></ul></li></ul><a href="#md:building-a-logger"><span>Building <wbr/>A <wbr/>Logger</span></a><ul><li><a href="#md:example"><span>Example</span></a></li><li><a href="#md:parsing-logoptions"><span>Parsing <wbr/>Log<wbr/>Options</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="index.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="assets/icons.svg#icon-1"></use></svg><span>@foxxmd/logging Docs</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base="."><li>Loading...</li></ul></nav></div></div></div><div class="tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div></body></html>